**.subckt DAC_6bit_testbench
V8 ?1 Vdd ?1 GND  1.8
**** end_element
V4 ?1 D0 ?1 GND  pulse 0 1.8 8u .1n .1n 8u 16u
**** end_element
V21 ?1 D1 ?1 GND  pulse 0 1.8 16u .1n .1n 16u 32u
**** end_element
V5 ?1 D2 ?1 GND  pulse 0 1.8 32u .1n .1n 32u 64u
**** end_element
V1 ?1 In1 ?1 GND  1.8
**** end_element
V2 ?1 In2 ?1 GND  0
**** end_element
V3 ?1 D3 ?1 GND  pulse 0 1.8 64u .1n .1n 64u 128u
**** end_element
V6 ?1 D4 ?1 GND  pulse 0 1.8 128u .1n .1n 128u 256u
**** end_element
x1 ?1 Vdd ?1 out ?1 D3 ?1 D2 ?1 D1 ?1 D0 ?1 In2 ?1 D4 ?1 D5 ?1 In1  DAC_6bit
**** end_element
V7 ?1 D5 ?1 GND  pulse 0 1.8 256u .1n .1n 256u 512u
**** end_element
**** begin user architecture code
 
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_01v8/sky130_fd_pr__nfet_01v8__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_01v8_lvt/sky130_fd_pr__nfet_01v8_lvt__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8/sky130_fd_pr__pfet_01v8__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_03v3_nvt/sky130_fd_pr__nfet_03v3_nvt__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_05v0_nvt/sky130_fd_pr__nfet_05v0_nvt__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/esd_nfet_01v8/sky130_fd_pr__esd_nfet_01v8__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8_lvt/sky130_fd_pr__pfet_01v8_lvt__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8_hvt/sky130_fd_pr__pfet_01v8_hvt__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/esd_pfet_g5v0d10v5/sky130_fd_pr__esd_pfet_g5v0d10v5__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_g5v0d10v5/sky130_fd_pr__pfet_g5v0d10v5__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_g5v0d16v0/sky130_fd_pr__pfet_g5v0d16v0__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_g5v0d10v5/sky130_fd_pr__nfet_g5v0d10v5__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_g5v0d16v0/sky130_fd_pr__nfet_g5v0d16v0__tt_discrete.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/esd_nfet_g5v0d10v5/sky130_fd_pr__esd_nfet_g5v0d10v5__tt.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/corners/tt/nonfet.spice
* Mismatch parameters
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_01v8/sky130_fd_pr__nfet_01v8__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8/sky130_fd_pr__pfet_01v8__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_01v8_lvt/sky130_fd_pr__nfet_01v8_lvt__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8_lvt/sky130_fd_pr__pfet_01v8_lvt__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_01v8_hvt/sky130_fd_pr__pfet_01v8_hvt__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_g5v0d10v5/sky130_fd_pr__nfet_g5v0d10v5__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/pfet_g5v0d10v5/sky130_fd_pr__pfet_g5v0d10v5__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_05v0_nvt/sky130_fd_pr__nfet_05v0_nvt__mismatch.corner.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/cells/nfet_03v3_nvt/sky130_fd_pr__nfet_03v3_nvt__mismatch.corner.spice
* Resistor~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/Capacitor
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/r+c/res_typical__cap_typical.spice
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/r+c/res_typical__cap_typical__lin.spice
* Special cells
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/corners/tt/specialized_cells.spice
* All models
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/all.spice
* Corner
.include ~/skywater-pdk/libraries/sky130_fd_pr_ngspice/latest/models/corners/tt/rf.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/nand3/sky130_fd_sc_hd__nand3_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/nand2/sky130_fd_sc_hd__nand2_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/nor3/sky130_fd_sc_hd__nor3_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/dfrtp/sky130_fd_sc_hd__dfrtp_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/nor2/sky130_fd_sc_hd__nor2_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/dlrbn/sky130_fd_sc_hd__dlrbn_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/a31o/sky130_fd_sc_hd__a31o_2.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/inv/sky130_fd_sc_hd__inv_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/a222oi/sky130_fd_sc_hd__a222oi_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/or2/sky130_fd_sc_hd__or2_1.spice
.include ~/skywater-pdk/libraries/sky130_fd_sc_hd/latest/cells/o221ai/sky130_fd_sc_hd__o221ai_1.spice

 
**** end user architecture code
**.ends

* expanding   symbol:  DAC_6bit.sym # of pins=10
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_6bit.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_6bit.sch
.subckt DAC_6bit  Vdd Out D3 D2 D1 D0 In2 D4 D5 In1  
R8 ?1 In1 ?1 vref1  250 m=1
**** end_element
R6 ?1 vref1 ?1 In2  250 m=1
**** end_element
x3 ?1 out ?1 net1 ?1 net2 ?1 Vdd ?1 D5  TG
**** end_element
x1 ?1 __UNCONNECTED_PIN__0 ?1 __UNCONNECTED_PIN__1 ?1 __UNCONNECTED_PIN__2 ?1 __UNCONNECTED_PIN__3 ?1 __UNCONNECTED_PIN__4 ?1 __UNCONNECTED_PIN__5 ?1 __UNCONNECTED_PIN__6 ?1 __UNCONNECTED_PIN__7 ?1 __UNCONNECTED_PIN__8 ?1 __UNCONNECTED_PIN__9  DAC_6bit
**** end_element
x1 ?1 Vdd ?1 net1 ?1 D3 ?1 D2 ?1 D1 ?1 D0 ?1 vref1 ?1 D4 ?1 In1  DAC_5bit
**** end_element
x2 ?1 Vdd ?1 net2 ?1 D3 ?1 D2 ?1 D1 ?1 D0 ?1 In2 ?1 D4 ?1 vref1  DAC_5bit
**** end_element
.ends


* expanding   symbol:  TG.sym # of pins=5
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/TG.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/TG.sch
.subckt TG  Out In1 In2 Vdd D  
**** spice_prefix X
M1 ?1 Dinv ?1 D ?1 GND ?1 GND  sky130_fd_pr__nfet_01v8 L=0.15 W=0.6
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M2 ?1 Dinv ?1 D ?1 Vdd ?1 Vdd  sky130_fd_pr__pfet_01v8 L=0.15 W=1.2
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M3 ?1 net1 ?1 Dinv ?1 GND ?1 GND  sky130_fd_pr__nfet_01v8 L=0.15 W=0.6
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M4 ?1 net1 ?1 Dinv ?1 Vdd ?1 Vdd  sky130_fd_pr__pfet_01v8 L=0.15 W=1.2
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M5 ?1 Out ?1 net1 ?1 In2 ?1 In2  sky130_fd_pr__nfet_01v8 L=0.15 W=0.6
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M6 ?1 Out ?1 net1 ?1 In1 ?1 In1  sky130_fd_pr__pfet_01v8 L=0.15 W=1.2
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M7 ?1 In2 ?1 Dinv ?1 Out ?1 Out  sky130_fd_pr__pfet_01v8 L=0.15 W=1.2
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
**** spice_prefix X
M8 ?1 In1 ?1 Dinv ?1 Out ?1 Out  sky130_fd_pr__nfet_01v8 L=0.15 W=0.6
+ nf=1 ad='int((nf+1)/2) * W/nf * 0.29' as='int((nf+2)/2) * W/nf * 0.29' pd='2*int((nf+1)/2) * (W/nf + 0.29)' ps='2*int((nf+2)/2) * (W/nf + 0.29)'
+ nrd='0.29 / W' nrs='0.29 / W' sa=0 sb=0 sd=0 
+ mult=1 m=1
**** end_element
.ends


* expanding   symbol:  DAC_5bit.sym # of pins=9
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_5bit.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_5bit.sch
.subckt DAC_5bit  Vdd Out D3 D2 D1 D0 In2 D4 In1  
R8 ?1 In1 ?1 vref1  250 m=1
**** end_element
R6 ?1 vref1 ?1 In2  250 m=1
**** end_element
x3 ?1 out ?1 net1 ?1 net2 ?1 Vdd ?1 D4  TG
**** end_element
x1 ?1 Vdd ?1 net1 ?1 D3 ?1 D2 ?1 D1 ?1 D0 ?1 vref1 ?1 In1  DAC_4bit
**** end_element
x2 ?1 Vdd ?1 net2 ?1 D3 ?1 D2 ?1 D1 ?1 D0 ?1 In2 ?1 vref1  DAC_4bit
**** end_element
.ends


* expanding   symbol:  DAC_4bit.sym # of pins=8
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_4bit.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_4bit.sch
.subckt DAC_4bit  Vdd Out D3 D2 D1 D0 In2 In1  
R8 ?1 In1 ?1 vref1  250 m=1
**** end_element
R6 ?1 vref1 ?1 In2  250 m=1
**** end_element
x3 ?1 out ?1 net2 ?1 net1 ?1 Vdd ?1 D3  TG
**** end_element
x1 ?1 Vdd ?1 net2 ?1 In1 ?1 D2 ?1 D1 ?1 D0 ?1 vref1  DAC_3bit
**** end_element
x2 ?1 Vdd ?1 net1 ?1 vref1 ?1 D2 ?1 D1 ?1 D0 ?1 In2  DAC_3bit
**** end_element
.ends


* expanding   symbol:  DAC_3bit.sym # of pins=7
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_3bit.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_3bit.sch
.subckt DAC_3bit  Vdd Out In1 D2 D1 D0 In2  
x1 ?1 Vdd ?1 net2 ?1 In1 ?1 D1 ?1 D0 ?1 vref1  DAC_2bit
**** end_element
x2 ?1 Vdd ?1 net1 ?1 vref1 ?1 D1 ?1 D0 ?1 In2  DAC_2bit
**** end_element
R8 ?1 In1 ?1 vref1  250 m=1
**** end_element
R6 ?1 vref1 ?1 In2  250 m=1
**** end_element
x3 ?1 out ?1 net2 ?1 net1 ?1 Vdd ?1 D2  TG
**** end_element
.ends


* expanding   symbol:  DAC_2bit.sym # of pins=6
* sym_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_2bit.sym
* sch_path: /home/mahashatta/.xschem/xschem_library/xschem_sky130/DAC_2bit.sch
.subckt DAC_2bit  Vdd Out In1 D1 D0 In2  
x1 ?1 net1 ?1 net3 ?1 net4 ?1 Vdd ?1 D0  TG
**** end_element
x2 ?1 net2 ?1 net5 ?1 In2 ?1 Vdd ?1 D0  TG
**** end_element
x3 ?1 out ?1 net1 ?1 net2 ?1 Vdd ?1 D1  TG
**** end_element
R1 ?1 In1 ?1 net3  500 m=1
**** end_element
R2 ?1 net3 ?1 net4  500 m=1
**** end_element
R3 ?1 net4 ?1 net5  500 m=1
**** end_element
R4 ?1 net5 ?1 In2  500 m=1
**** end_element
.ends

.GLOBAL GND
**** begin user architecture code


.temp 25
vvcc vcc 0 1.8
vvss vss 0 0
.control
tran 8u 512u
plot D0 D1+2 D2+4 D3+6 D4+8 D5+10 out+12
.endc


**** end user architecture code
.end
